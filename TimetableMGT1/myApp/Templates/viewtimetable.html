{% extends 'index.html' %}
{% block title %}View Timetable{% endblock title %}

{% block content %}
<style>
    :root {
        --bg-color: #e0e5ec;
        --shadow-light: #ffffff;
        --shadow-dark: #a3b1c6;
        --primary-color: #2a3f5f;
    }

    body {
        margin: 0;
        padding: 0;
        font-family: "Segoe UI", sans-serif;
        background: var(--bg-color);
    }

    /* Filter Form */
    .filter-form {
        display: flex;
        flex-wrap: wrap;
        gap: 1rem;
        align-items: flex-end;
        justify-content: center;
        padding: 1rem;
        margin-bottom: 2rem;
        border-radius: 20px;
        background: var(--bg-color);
        box-shadow: 9px 9px 16px var(--shadow-dark),
                    -9px -9px 16px var(--shadow-light);
    }

    .filter-group {
        display: flex;
        flex-direction: column;
        min-width: 150px;
        flex: 1 1 150px;
    }

    .filter-group label {
        font-weight: 600;
        color: var(--primary-color);
        font-size: 14px;
        margin-bottom: 6px;
    }

    select {
        padding: 0.6rem 0.8rem;
        border-radius: 12px;
        border: none;
        background: var(--bg-color);
        box-shadow: inset 4px 4px 8px var(--shadow-dark),
                    inset -4px -4px 8px var(--shadow-light);
        font-size: 14px;
        color: var(--primary-color);
        cursor: pointer;
    }

    select:focus {
        outline: none;
        box-shadow: inset 2px 2px 6px var(--shadow-dark),
                    inset -2px -2px 6px var(--shadow-light);
    }

    button[type="submit"], .reset-btn {
        padding: 0.6rem 1rem;
        border-radius: 12px;
        border: none;
        font-weight: 600;
        font-size: 14px;
        cursor: pointer;
        background: var(--bg-color);
        color: var(--primary-color);
        box-shadow: 5px 5px 10px var(--shadow-dark),
                    -5px -5px 10px var(--shadow-light);
        transition: all 0.2s ease;
        margin-top: 22px;
    }

    button:hover, .reset-btn:hover {
        box-shadow: inset 4px 4px 8px var(--shadow-dark),
                    inset -4px -4px 8px var(--shadow-light);
    }

    /* Table */
    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 1rem;
        border-radius: 20px;
        overflow: hidden;
        background: var(--bg-color);
        box-shadow: 9px 9px 16px var(--shadow-dark),
                    -9px -9px 16px var(--shadow-light);
    }

    thead {
        background: var(--primary-color);
        color: #fff;
    }

    thead th {
        padding: 12px;
        font-weight: 600;
        text-align: center;
    }

    tbody td {
        padding: 12px;
        text-align: center;
        font-weight: 500;
        color: var(--primary-color);
        border-top: 1px solid rgba(0,0,0,0.05);
    }

    tbody tr:hover {
        background: #f5f7fa;
    }

    @media (max-width: 768px) {
        .filter-form {
            flex-direction: column;
            align-items: stretch;
        }
        .filter-group {
            width: 100%;
        }
    }
</style>

<form method="get" class="filter-form">
    <div class="filter-group">
        <label for="day">Day</label>
        <select name="day" id="day">
            <option value="">All</option>
            {% for d in days %}
                <option value="{{ d }}" {% if d == day_filter %}selected{% endif %}>{{ d }}</option>
            {% endfor %}
        </select>
    </div>

    <div class="filter-group">
        <label for="faculty">Faculty</label>
        <select name="faculty" id="faculty">
            <option value="">All</option>
            {% for f in faculties %}
                <option value="{{ f }}" {% if f == faculty_filter %}selected{% endif %}>{{ f }}</option>
            {% endfor %}
        </select>
    </div>

    <div class="filter-group">
        <label for="subject">Subject</label>
        <select name="subject" id="subject">
            <option value="">All</option>
            {% for s in subjects %}
                <option value="{{ s }}" {% if s == subject_filter %}selected{% endif %}>{{ s }}</option>
            {% endfor %}
        </select>
    </div>

    <div class="filter-group">
        <label for="course">Course</label>
        <select name="course" id="course">
            <option value="">All</option>
            {% for c in courses %}
                <option value="{{ c }}" {% if c == course_filter %}selected{% endif %}>{{ c }}</option>
            {% endfor %}
        </select>
    </div>

    <div class="filter-group">
        <label for="room">Room</label>
        <select name="room" id="room">
            <option value="">All</option>
            {% for r in rooms %}
                <option value="{{ r }}" {% if r == room_filter %}selected{% endif %}>{{ r }}</option>
            {% endfor %}
        </select>
    </div>

    <div class="filter-group">
        <label for="year">Year</label>
        <select name="year" id="year">
            <option value="">All</option>
            {% for y in years %}
                <option value="{{ y }}" {% if y == year_filter %}selected{% endif %}>{{ y }}</option>
            {% endfor %}
        </select>
    </div>

    <button type="submit">Filter</button>
    <a href="{% url 'viewtimetable' %}" class="reset-btn">Reset</a>
</form>

<table>
    <thead>
        <tr>
            <th>Time</th>
            <th>Day</th>
            <th>Room</th>
            <th>Subject</th>
            <th>Faculty</th>
            <th>Course</th>
            <th>Year</th>
        </tr>
    </thead>
    <tbody>
    {% for entry in timetable %}
        <tr>
            <td>{{ entry.time }}</td>
            <td>{{ entry.day }}</td>
            <td>{{ entry.room }}</td>
            <td>{{ entry.subject }}</td>
            <td>{{ entry.teacher }}</td>
            <td>{{ entry.course }}</td>
            <td>{{ entry.year }}</td>
        </tr>
    {% empty %}
        <tr>
            <td colspan="7" style="font-style: italic; color: #777;">
                No timetable data available.
            </td>
        </tr>
    {% endfor %}
    </tbody>
</table>
{% endblock content %}
